# ExternalSecret for Phoenix auth secrets
#
# Phoenix requires:
#   - PHOENIX_SECRET: Used for session signing
#   - PHOENIX_ADMIN_SECRET: Used for admin API access
#
# SSM Parameters required:
#   /siggy/phoenix/secret
#   /siggy/phoenix/admin-secret

apiVersion: external-secrets.io/v1
kind: ExternalSecret
metadata:
  name: phoenix-secrets
  namespace: siggy
spec:
  refreshInterval: 1h

  secretStoreRef:
    name: aws-parameter-store
    kind: ClusterSecretStore

  target:
    name: phoenix-secrets
    creationPolicy: Owner

  data:
    - secretKey: PHOENIX_SECRET
      remoteRef:
        key: /siggy/phoenix/secret
    - secretKey: PHOENIX_ADMIN_SECRET
      remoteRef:
        key: /siggy/phoenix/admin-secret
