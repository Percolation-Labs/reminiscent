# Example Session with Compression and LOOKUP Keys
# Generated by: python -m pytest tests/integration/test_yaml_export.py -xvs

session_id: demo-session-abc-123
tenant_id: acme-corp
user_id: alice
message_count: 4
compressed_count: 2

messages:
  # Message 0: Short user message - NOT compressed
  - index: 0
    role: user
    timestamp: '2025-01-20T10:00:00Z'
    original_length: 12
    compressed_length: 12
    is_compressed: false
    lookup_key: null
    content: What is REM?

  # Message 1: Long assistant response - COMPRESSED
  - index: 1
    role: assistant
    timestamp: '2025-01-20T10:00:05Z'
    original_length: 777
    compressed_length: 503
    is_compressed: true
    lookup_key: session-demo-session-abc-123-msg-1
    content: |
      REM (Resources Entities Moments) is a bio-inspired memory architecture for agentic AI workloads. It mirrors human memory systems by organizing information into three main components:

      **Resources**: C

      ... [Message truncated - REM LOOKUP session-demo-session-abc-123-msg-1 to recover full content] ...

      time-bound events that enable chronological memory retrieval.

      REM provides multi-index organization with vector embeddings, knowledge graphs, and temporal indexing for flexible information retrieval.

  # Message 2: Short user message - NOT compressed
  - index: 2
    role: user
    timestamp: '2025-01-20T10:01:00Z'
    original_length: 32
    compressed_length: 32
    is_compressed: false
    lookup_key: null
    content: How do I perform a LOOKUP query?

  # Message 3: Long assistant response - COMPRESSED
  - index: 3
    role: assistant
    timestamp: '2025-01-20T10:01:10Z'
    original_length: 554
    compressed_length: 503
    is_compressed: true
    lookup_key: session-demo-session-abc-123-msg-3
    content: |
      LOOKUP queries provide O(1) retrieval by entity label. Here's how to use them:

      ```python
      from rem.models.core import REMQuery, QueryType

      # Create a LOOKUP query
      query = REMQuery(
          type=QueryType.

      ... [Message truncated - REM LOOKUP session-demo-session-abc-123-msg-3 to recover full content] ...

      t rem_service.execute_query(query)
      ```

      LOOKUP queries are ideal when you know the exact entity label. They're the fastest retrieval method in REM and don't require semantic search or graph traversal.

# LOOKUP Recovery Process
# To recover full content for compressed messages:
#
# SQL Query:
#   SELECT * FROM messages
#   WHERE metadata->>'entity_key' = 'session-demo-session-abc-123-msg-1'
#     AND tenant_id = 'acme-corp'
#     AND deleted_at IS NULL
#   LIMIT 1
#
# Returns: Full message content stored in the 'content' field
#
# Compression Stats:
#   Message 1: 777 chars → 503 chars (35% reduction)
#   Message 3: 554 chars → 503 chars (9% reduction)
